<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>배송 관리 - Admin</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; }
        .success-message { color: green; padding: 10px; background: #d4edda; border: 1px solid #c3e6cb; }
        select, input { padding: 5px; }
        button { padding: 8px 16px; background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>배송 관리</h1>

    {% if request.query_params.get('success') %}
    <div class="success-message">{{ request.query_params.get('success') }}</div>
    {% endif %}

    <table>
        <thead>
            <tr>
                <th>주문번호</th>
                <th>고객명</th>
                <th>고객 이메일</th>
                <th>배송 상태</th>
                <th>운송장 번호</th>
                <th>택배사</th>
                <th>관리</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr id="order-{{ order.id }}">
                <td>{{ order.order_number }}</td>
                <td>{{ order.customer_name }}</td>
                <td>{{ order.customer_email }}</td>
                <td class="status">
                    {% if order.shipment %}
                        {{ order.shipment.shipping_status }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td class="tracking">
                    {% if order.shipment and order.shipment.tracking_number %}
                        {{ order.shipment.tracking_number }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td class="courier">
                    {% if order.shipment and order.shipment.courier %}
                        {{ order.shipment.courier }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    <form method="POST" action="/admin/shipments/{{ order.id }}">
                        <select name="status" id="order-{{ order.id }}-status">
                            <option value="PREPARING">준비중</option>
                            <option value="SHIPPED">배송중</option>
                            <option value="DELIVERED">배송완료</option>
                        </select>
                        <input type="text" name="tracking_number" id="order-{{ order.id }}-tracking" placeholder="운송장번호" />
                        <select name="courier" id="order-{{ order.id }}-courier">
                            <option value="">택배사 선택</option>
                            <option value="LBC Express">LBC Express</option>
                            <option value="J&T Express">J&T Express</option>
                            <option value="Ninja Van">Ninja Van</option>
                            <option value="Flash Express">Flash Express</option>
                            <option value="JRS Express">JRS Express</option>
                            <option value="2GO Express">2GO Express</option>
                        </select>
                        <button type="submit" id="order-{{ order.id }}-submit">저장</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
