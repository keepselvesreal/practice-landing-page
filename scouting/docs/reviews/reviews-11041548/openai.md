# Review by Openai

**Model**: gpt-5-mini
**Timestamp**: 2025-11-04T15:46:38.638692

## Feedback

정확성: 몇 가지 기술적/논리적 불일치가 있습니다.
- API 오류 페이로드 형태 불일치: 구현에서 HTTPException(detail={...})를 사용하면 실제 응답은 {"detail": {...}} 형태가 되는데, 테스트(test_not_found)에서는 data["code"] (최상위)를 검사하도록 되어 있어 모순이 있습니다(테스트 또는 예외 처리 중 하나를 수정해야 함). 프런트엔드 코드는 error.detail.error 형태를 기대하고 있어 프런트엔드와 테스트 간 기대값이 일치하지 않습니다.  
- 화폐 단위/표시 불일치: DB 스키마 주석에 "센타보(centavo) 단위"라 명시되어 있고 프론트엔드에서는 총액을 (order.total_amount / 100)으로 나눈 뒤 ₱ 기호를 사용합니다. 한편 서버·테스트 데이터에는 unit_price=57500, total_amount=115000(숫자 그대로)로 표현되어 있어 단위(centavo vs 원/페소)와 통화 심볼(₱)이 일관되지 않습니다. 단위·심볼·포맷을 명확히 통일해야 합니다.  
- 사소한 표기 오류: 문서의 기술 스택에 "패키지 관리: uv"는 오타(예: pip/poetry/venv/uvicorn과 혼동)로 보입니다.  
- 함수/부작용 위험: app.database.execute_update가 호출자에서 전달한 set_clause dict를 직접 수정(set_clause["updated_at"]=...)합니다. 호출자가 같은 dict를 재사용한다면 부작용이 발생할 수 있으므로 내부에서 복사하거나 새로운 dict를 생성하는 것이 안전합니다.

적절성: 전반적으로 테스트/아키텍처 전략은 합리적이나 몇 가지 보완 권고가 있습니다.
- 테스트와 구현의 인터페이스 기대(에러 응답 구조 등)를 명확히 문서화하고 일관되게 맞추세요(현재 테스트와 구현/프론트엔드 간 불일치 존재).  
- 테스트 DB/앱 초기화 시점 취급의 취약성: conftest.test_client가 app을 import한 후 app.database.DB_PATH를 덮어쓰는 방식은 현재 동작하지만(대부분의 경우 안전) 임포트 순서에 따라 취약할 수 있습니다. 테스트 DB 설정은 app 모듈을 import하기 전에 적용하거나 환경변수 같은 외부 설정을 통해 주입하는 방식이 더 견고합니다.  
- 누락 테스트/보완 사항(문서에서도 지적한 항목들이 타당함): 주문번호 형식 검증, SQL 인젝션/입력 유효성, 동시성(동시 요청) 관련 테스트, 에러 응답의 표준화(에러 코드/메시지 스펙) 등은 추가하는 것이 좋습니다.  
- 성능·운영 관련 고려: 1-b 단계에서는 동기 SQLite와 매 테스트 DB 재생성 전략이 적절하지만(단순성 우선), 프로덕션 전환 또는 테스트 속도 개선을 위해 트랜잭션 롤백, 커넥션 풀/비동기 전환, 혹은 DB 접근 추상화(테스트용 설정 주입)를 계획해두는 것이 바람직합니다.  

요약: 핵심적으로는 (1) 에러 응답 구조에 대한 테스트 ↔ 구현 ↔ 프런트엔드 기대치 불일치, (2) 금액 단위 및 통화 표시의 불일치, (3) execute_update의 입력 dict 직접 수정 같은 기술적 이슈가 있습니다. 그 외 문서에서 지적한 테스트 보강 항목들은 타당하며 권장됩니다.
