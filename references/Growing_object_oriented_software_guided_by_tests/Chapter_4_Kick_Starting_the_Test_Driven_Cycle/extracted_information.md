# Growing_object_oriented_software_guided_by_tests_Chapter 4: Kick-Starting the Test-Driven Cycle

## 압축 내용

TDD 프로세스를 시작하려면 Walking Skeleton(최소 기능 구현체)을 먼저 구축하여 자동화된 빌드-배포-테스트 인프라를 확립한 후, 이를 기반으로 실제 기능의 인수 테스트를 작성해야 하며, 이는 초기에 불확실성을 드러내고 피드백 루프를 조기에 구축하여 프로젝트 리스크를 감소시킨다.

## 핵심 내용

### 핵심 개념들
1. **Walking Skeleton** (참조: [상세 내용 1.1])
2. **End-to-End Testing** (참조: [상세 내용 1.2])
3. **Early Feedback** (참조: [상세 내용 2.1, 3.1])
4. **Infrastructure First** (참조: [상세 내용 1.1, 2.1])
5. **Incremental Development** (참조: [상세 내용 3.1])

### 핵심 개념 설명

**1. Walking Skeleton** (참조: [상세 내용 1.1])
- 자동으로 빌드, 배포, 테스트할 수 있는 가장 얇은 실제 기능 구현체
- 주요 컴포넌트와 통신 메커니즘만 포함하되, 애플리케이션 기능은 단순하게 유지
- 첫 번째 기능 개발을 위한 인프라 구축에 집중

**2. End-to-End Testing** (참조: [상세 내용 1.2])
- 처음부터 끝까지(빌드-배포-테스트) 전체 프로세스를 자동화
- 배포 단계를 테스트 프로세스에 포함시키는 것이 중요
- 실제 환경과 유사한 환경에서 시스템 전체를 테스트

**3. Early Feedback** (참조: [상세 내용 2.1, 3.1])
- 프로젝트 초기에 기술적/조직적 리스크를 파악하고 대응
- 실제 사용자에게 정기적으로 릴리스하여 요구사항 이해도 검증
- 자동화된 회귀 테스트를 통해 안전한 변경 가능

**4. Infrastructure First** (참조: [상세 내용 1.1, 2.1])
- 기능 개발 전에 자동화 인프라를 먼저 구축
- 빌드, 배포, 테스트 자동화를 통해 시스템 품질에 대한 피드백 확보
- 완벽한 인프라가 아닌 첫 단계로서의 인프라 구축

**5. Incremental Development** (참조: [상세 내용 3.1])
- 초기에 스트레스가 집중되지만 프로젝트 후반부로 갈수록 안정화
- 늦은 통합보다 초기 통합이 예측 가능성을 높임
- 전체 프로젝트가 아닌 화이트보드 수준의 결정만 내리고 변경 권한 보유

### 핵심 개념 간 관계

**Walking Skeleton**은 **End-to-End Testing**을 가능하게 하는 최소 구현체이며, **Infrastructure First** 접근을 통해 구축됩니다. 이를 통해 **Early Feedback**을 얻을 수 있으며, **Incremental Development** 방식으로 시스템을 성장시킬 수 있는 기반이 됩니다. Walking Skeleton 구축 과정에서 조기에 불확실성을 드러내면서도, 이후 실제 기능 개발은 더 빠르게 진행할 수 있게 됩니다.

## 상세 내용

### 목차
1. 첫 번째 테스트의 역설과 Walking Skeleton
   1.1 Walking Skeleton의 정의와 목적
   1.2 End-to-End 테스팅의 중요성
   1.3 Walking Skeleton의 설계 결정
2. 피드백 시스템 구축
   2.1 피드백 소스 구축
3. 불확실성의 조기 노출
   3.1 점진적 개발의 스트레스 패턴
   3.2 Brownfield 개발

---

### 1. 첫 번째 테스트의 역설과 Walking Skeleton

**화제 배경**: TDD 프로세스는 기존 인프라에 새로운 기능의 테스트를 추가하는 것을 전제로 하지만, 첫 번째 기능은 이러한 인프라가 없는 상태에서 시작해야 하는 역설적 상황에 직면합니다. (Lines 10-16)

#### 1.1 Walking Skeleton의 정의와 목적 [핵심 개념: Walking Skeleton, Infrastructure First]

**이전 화제와의 관계**: 첫 번째 테스트의 역설 문제를 해결하기 위한 구체적 방법론을 제시합니다.

**Walking Skeleton의 정의** (Lines 46-51)
- 자동으로 빌드, 배포, end-to-end 테스트할 수 있는 가장 얇은 실제 기능의 구현체
- 자동화, 주요 컴포넌트, 통신 메커니즘만 포함
- 애플리케이션 기능은 명백하고 단순하게 유지하여 인프라에 집중 가능

**Walking Skeleton의 예시** (Lines 52-55)
```
데이터베이스 기반 웹 애플리케이션의 경우:
- 데이터베이스 필드를 표시하는 단순한 웹 페이지
- UI에 단일 값 표시
- 서버에 핸드셰이크 메시지만 전송
```

**First Feature Paradox 해결 전략** (Lines 41-45)
1. Walking Skeleton을 빌드, 배포, 테스트하는 방법 해결
2. 해당 인프라를 사용하여 첫 번째 의미 있는 기능의 인수 테스트 작성
3. 이후 시스템의 나머지 부분을 TDD로 개발

**Walking Skeleton 구축 시 주의사항** (Lines 82-88)
- 구조에 집중하고 테스트를 아름답게 표현하는 것에 과도하게 신경 쓰지 않음
- Walking Skeleton은 TDD 시작 방법을 이해하는 도구
- 첫 번째 기능의 테스트를 작성할 때 "읽고 싶은 테스트 작성" (page 42)

#### 1.2 End-to-End 테스팅의 중요성 [핵심 개념: End-to-End Testing, Early Feedback]

**이전 화제와의 관계**: Walking Skeleton이 왜 end-to-end 방식으로 구축되어야 하는지 설명합니다.

**End-to-End의 의미** (Lines 56-67)
- 프로세스와 시스템 모두를 포함
- 처음부터 배포 가능한 시스템을 빌드하고, 프로덕션과 유사한 환경에 배포한 후 테스트 실행
- 배포 단계를 테스트 프로세스에 포함시키는 것이 중요한 두 가지 이유:
  1. 오류가 발생하기 쉬운 작업을 수작업으로 하지 않기 위함
  2. 개발팀이 조직의 나머지 부분과 충돌하는 순간 (예: 데이터베이스 설정에 6주 소요)

**실무에서의 End-to-End 테스팅** (Lines 68-81)
- 진정한 end-to-end 테스팅이 어려울 경우, 현재 이해를 구현한 인프라로 시작
- 이는 임시방편이며, 실제 end-to-end 테스트가 실행될 때까지 알려지지 않은 리스크 존재
- 예시: Auction Sniper 예제는 실제 사이트가 아닌 더미 서버에 대해 테스트 실행

**End-to-End 테스팅 지연의 사례** (Lines 90-107)
```
실제 프로젝트 사례 (Lines 90-107):

문제 상황:
- 2년간 실행되었지만 전체 시스템 end-to-end 테스트 미수행
- 빈번한 프로덕션 중단 및 배포 실패
- 대규모 복잡한 시스템

해결 시도:
- 새로운 팀을 구성하여 자동화된 end-to-end 테스트 스위트 구축
- 수개월 소요
- 전체 시스템을 end-to-end 테스트로 커버하는 데 실패

근본 원인:
- End-to-end 테스팅 필요성이 설계에 영향을 주지 않아 테스트가 어려움
- 예: 내부 타이머로 며칠/주 단위 활동 스케줄링
  → 실시간으로 테스트 실행 불가능
  → 외부에서 스케줄링 영향 불가능

해결책:
- 시스템 재설계: 원격 스케줄러에서 메시지로 주기적 활동 트리거
- 테스트 환경에서 스케줄러 교체 가능하게 변경
- "Externalize Event Sources" 패턴 (page 326)
- 중요한 아키텍처 변경이었으며 end-to-end 테스트 커버리지 없이 수행되어 매우 위험
```

#### 1.3 Walking Skeleton의 설계 결정 [핵심 개념: Walking Skeleton, Infrastructure First]

**이전 화제와의 관계**: Walking Skeleton을 어떻게 설계할 것인지 구체적인 접근 방법을 제시합니다.

**설계 수준** (Lines 109-115)
- 애플리케이션의 고수준 구조에 대한 선택을 시작하는 순간
- 첫 번째 계획된 릴리스를 지원하는 데 필요한 주요 시스템 컴포넌트와 통신 방법에 대한 대략적인 그림
- 경험 법칙: 몇 분 안에 화이트보드에 Walking Skeleton 설계를 그릴 수 있어야 함

**Mappa Mundi (지도)** (Lines 121-126)
- 시스템 구조의 공개 도면을 유지 (예: 팀 작업 공간 벽)
- 코드 작업 시 팀이 방향을 잃지 않도록 도움
- Figure 4.1 참조

**설계를 위한 전제 조건** (Lines 127-136)
- 시스템의 목적에 대한 이해 필요
- 클라이언트의 기능적/비기능적 요구사항에 대한 고수준 관점
- 프로젝트 차터링 작업의 일부 (본 책의 범위 밖)
- Walking Skeleton의 목적: 첫 번째 테스트 작성을 통해 프로젝트 컨텍스트 도출
- Figure 4.2: TDD 프로세스가 이 컨텍스트에 어떻게 들어맞는지 표시

**Big Design Up Front (BDUF)와의 차이** (Lines 144-150)
- BDUF와 혼동하지 말 것
- 클래스와 알고리즘까지 전체 설계를 정교화하지 않음
- 현재 아이디어는 틀릴 가능성이 높으므로 시스템을 성장시키면서 세부 사항 발견 선호
- TDD 사이클을 시작하기 위한 최소한의 결정만 내림
- 실제 피드백으로부터 학습하고 개선 시작

---

### 2. 피드백 시스템 구축

**이전 화제와의 관계**: Walking Skeleton 설계 후, 이를 통해 얻을 수 있는 피드백 시스템을 구축하는 방법을 설명합니다.

#### 2.1 피드백 소스 구축 [핵심 개념: Early Feedback, Infrastructure First]

**설계 결정의 불확실성** (Lines 152-158)
- 애플리케이션 설계나 가정이 옳다는 보장 없음
- 최선을 다하되, 가능한 한 빨리 검증하는 것만 신뢰 가능
- Walking Skeleton을 구현하는 도구는 학습 프로세스 지원
- 도구도 완벽하지 않으며 점진적으로 개선 예상

**이상적인 피드백 상황** (Lines 159-162)
```
이상적 상황 (Figure 4.3):
팀이 실제 프로덕션 시스템에 정기적으로 릴리스

장점:
1. 시스템 이해관계자가 시스템이 요구사항을 얼마나 잘 충족하는지 응답
2. 구현을 동시에 판단 가능
```

**자동화를 통한 피드백** (Lines 169-174)
- 빌드 및 테스트 자동화: 시스템 품질에 대한 피드백
  - 버전 생성 및 배포 용이성
  - 설계 작동 정도
  - 코드 품질
- 자동화된 배포: 실제 사용자에게 자주 릴리스
  - 도메인 이해도 검증
  - 실제 시스템 사용이 고객 우선순위를 변경했는지 확인

**테스트 주도 개발의 이점** (Lines 175-178)
- 모든 것을 테스트 우선으로 작성 → 철저한 회귀 테스트 세트 확보
- 완벽한 테스트는 없지만 실질적으로 상당한 테스트 스위트를 통해 안전하게 주요 변경 가능

---

### 3. 불확실성의 조기 노출

**이전 화제와의 관계**: 피드백 시스템 구축의 효과와 초기 투자의 가치를 설명합니다.

#### 3.1 점진적 개발의 스트레스 패턴 [핵심 개념: Early Feedback, Incremental Development]

**Walking Skeleton 구축의 시간 소요** (Lines 180-186)
```
팀들의 놀라움:
- 거의 아무것도 하지 않는데 시간이 많이 걸림

이유:
- 많은 인프라 구축
- 많은 어려운 질문 제기 및 답변
- 첫 몇 가지 기능 구현 시간 예측 불가능
  → 요구사항과 목표 환경에 대한 추가 발견
- 새 팀의 경우: 함께 일하는 방법 학습의 사회적 스트레스
```

**점진적 개발의 스트레스 프론트로딩** (Lines 187-195)
```
Fred Tingey의 관찰:
점진적 개발은 익숙하지 않은 팀과 관리자에게 당혹스러울 수 있음
→ 프로젝트의 스트레스를 초기에 집중시킴

늦은 통합 프로젝트:
- 차분하게 시작하지만 일반적으로 끝으로 갈수록 어려워짐
- 처음으로 시스템을 통합하려 시도하는 단계
- 예측 불가능: 제한된 시간과 예산으로 많은 움직이는 부품 조립 및 실패 수정
- 결과: 경험 있는 이해관계자는 점진적 프로젝트 시작의 불안정성에 부정적 반응
  (프로젝트 끝이 훨씬 더 나쁠 것으로 예상)
```

**잘 운영된 점진적 개발의 패턴** (Lines 196-209)
```
경험상 반대 방향으로 진행:
1. 불안정하게 시작
2. 몇 가지 기능 구현 및 프로젝트 자동화 구축 후 안정화
3. 일상으로 정착
4. 배포 접근 시: 꾸준한 기능 생산
   (첫 릴리스 전 활동 폭발 가능)
5. 배포 및 업그레이드 같은 평범하지만 취약한 작업 자동화
   → "그냥 작동"

Figure 4.4 대비 참조
```

**TDD의 역직관적 측면** (Lines 203-209)
- 시스템의 기본 구조와 자동화를 위한 충분한 시간 투자 가치
- 전체 프로젝트를 완벽한 Walking Skeleton 설정에 소비하지 않음
- 화이트보드 수준의 결정으로 제한
- 필요 시 마음을 바꿀 권리 보유
- 가장 중요한 것: 방향 감각과 가정을 테스트할 구체적 구현

**Walking Skeleton의 효과** (Lines 217-218)
- 프로젝트 초기에 문제를 드러냄
- 여전히 시간, 예산, 선의가 있을 때 문제 해결 가능

#### 3.2 Brownfield 개발 [핵심 개념: End-to-End Testing, Infrastructure First]

**이전 화제와의 관계**: 새로운 시스템이 아닌 기존 시스템을 다룰 때의 접근 방법을 설명합니다.

**Brownfield 개발의 정의** (Lines 220-227)
- 처음부터 새 시스템을 구축하는 것이 항상 가능한 것은 아님
- 많은 프로젝트가 기존 시스템 확장, 적응, 교체로 시작
- Walking Skeleton을 구축할 수 없음 → 기존 것으로 작업
- 기존 시스템의 TDD 시작 프로세스는 새 시스템 적용과 근본적으로 다르지 않음
  (시스템이 이미 가지고 있는 기술적 짐 때문에 훨씬 더 어려울 수 있음)
- Michael Feathers의 책 참조 [Feathers04]

**Brownfield 개발의 안전한 시작 방법** (Lines 228-233)
```
위험성:
- 회귀를 감지할 테스트가 없을 때 시스템을 재작업하는 것은 위험

안전한 시작 방법:
1. 빌드 및 배포 프로세스 자동화
2. 변경해야 할 코드 영역을 커버하는 end-to-end 테스트 추가
3. 이 보호를 통해 내부 품질 문제 해결 시작
4. 기능 추가 시 코드 리팩터링 및 단위 테스트 도입
```

**End-to-End 테스트 인프라 구축의 쉬운 방법** (Lines 234-237)
- 시스템을 통과하는 가장 간단한 경로로 시작
- Walking Skeleton처럼, 더 복잡한 기능 테스트 문제를 다루기 전에 지원 인프라 구축 가능

---

## 참조 정보

**책 이름**: Growing Object-Oriented Software, Guided by Tests
**장 번호**: Chapter 4
**장 제목**: Kick-Starting the Test-Driven Cycle
**페이지 범위**: 56-63
