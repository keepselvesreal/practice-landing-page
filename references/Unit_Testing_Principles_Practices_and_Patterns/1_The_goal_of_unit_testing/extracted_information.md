# 1장: 단위 테스트의 목표 - 추출된 정보

## 핵심 내용
- 단위 테스트의 목표는 지속 가능한 소프트웨어 프로젝트 성장 활성화
- 커버리지 메트릭을 사용한 테스트 스위트 품질 측정의 한계
- 성공적인 테스트 스위트의 속성과 특징
- 좋은 테스트와 나쁜 테스트의 차이점과 영향

## 상세 핵심 내용

### 단위 테스트의 목표
- **핵심 목표**: 소프트웨어 프로젝트의 지속 가능한(sustainable) 성장 활성화
- **소프트웨어 엔트로피**: 코드 변경 시마다 시스템의 무질서도(엔트로피)가 증가하는 현상
- **테스트의 역할**: 회귀(regression)를 방지하는 안전망 역할
- **지속가능성**: 장기적으로 개발 속도를 유지할 수 있게 해주는 핵심 요소

### 좋은 테스트 vs 나쁜 테스트
- **좋은 테스트**: 지속적인 개발 속도 유지, 안정적인 성장 곡선
- **나쁜 테스트**: 초기에는 도움이 되지만 결국 정체 단계에 진입
- **비용-편익 분석**: 각 테스트의 비용과 이익을 신중하게 평가해야 함
- **유지보수 비용**: 리팩터링, 실행, 거짓 알람 처리, 코드 이해 시간 등

## 상세 내용

### 현재 단위 테스트 상황
- 대부분의 회사에서 단위 테스트는 필수로 간주됨
- 기업 애플리케이션 개발에서 거의 모든 프로젝트가 단위 테스트 포함
- 프로덕션 코드 대 테스트 코드 비율: 1:1에서 1:3, 때로는 1:10까지
- 논의의 초점: "단위 테스트를 작성해야 하는가?"에서 "좋은 단위 테스트란 무엇인가?"로 전환

### 기업 애플리케이션 특성
```yaml
특성:
  - 높은 비즈니스 로직 복잡성
  - 긴 프로젝트 수명
  - 중간 수준의 데이터 처리량
  - 낮거나 중간 수준의 성능 요구사항
```

### 커버리지 메트릭의 문제점

#### 코드 커버리지 메트릭
- **정의**: 테스트 스위트에 의해 실행된 코드 라인 수 / 전체 코드 라인 수
- **문제점**: 코드 압축으로 쉽게 조작 가능, 실제 테스트 품질과 무관

#### 브랜치 커버리지 메트릭
- **정의**: 테스트로 탐색된 분기 수 / 전체 분기 수
- **장점**: 코드 커버리지보다 정확한 결과 제공
- **한계**: 여전히 테스트 품질 보장 불가

#### 커버리지 메트릭의 근본적 한계
1. **검증 부재**: 테스트가 모든 가능한 결과를 검증한다고 보장할 수 없음
2. **외부 라이브러리**: 외부 라이브러리의 코드 경로를 고려하지 못함
3. **Assertion-free 테스트**: 어설션 없는 테스트도 높은 커버리지 달성 가능

## 주요 화제

### 1. 단위 테스트의 진정한 목표
- 더 나은 설계는 부수적 효과일 뿐, 주 목표가 아님
- 지속 가능한 프로젝트 성장이 핵심 목표
- 엔트로피 증가 경향을 역전시키는 안전망 역할

### 2. 소프트웨어 엔트로피와 회귀
- **엔트로피**: 시스템의 무질서도, 열역학 제2법칙의 소프트웨어 적용
- **회귀**: 특정 이벤트(주로 코드 수정) 후 기능이 의도대로 작동하지 않는 현상
- **도미노 효과**: 하나의 버그 수정이 여러 다른 부분을 손상시키는 현상

### 3. 커버리지 메트릭 오용 사례
- **실제 사례**: 100% 코드 커버리지 의무화로 인한 부작용
- **게임화**: try/catch 블록과 어설션 없는 테스트로 커버리지 조작
- **결과**: 프로젝트에 가치를 더하지 못하고 오히려 손상

### 4. 테스트 스위트 품질 평가
- 자동화된 방법은 없음, 개인적 판단 필요
- 각 테스트를 개별적으로 하나씩 평가해야 함
- 점진적 평가 방식 권장

## 부차 화제

### 1. 프로덕션 코드 vs 테스트 코드
- 코드는 자산이 아닌 부채
- 테스트 코드도 버그에 취약하고 유지보수 필요
- "테스트가 많을수록 좋다"는 잘못된 믿음

### 2. 성공적인 테스트 스위트의 속성
1. **개발 사이클 통합**: 모든 코드 변경 시 실행
2. **중요한 부분에 집중**: 도메인 모델(비즈니스 로직)에 주력
3. **최대 가치, 최소 유지보수 비용**: 가장 어려운 부분이지만 핵심

### 3. 코드베이스 분류
- **가장 중요한 부분**: 비즈니스 로직 (도메인 모델)
- **기타 부분**:
  - 인프라 코드
  - 외부 서비스와 종속성 (데이터베이스, 서드파티 시스템)
  - 모든 것을 연결하는 접착제 코드

### 4. 책에서 다룰 내용
- 테스트 분석을 위한 참조 프레임워크
- 기존 단위 테스트 기법과 관행 분석
- 프로덕션 코드와 함께 테스트 스위트 리팩터링
- 다양한 단위 테스트 스타일 적용
- 통합 테스트를 통한 시스템 전체 동작 검증
- 단위 테스트의 안티패턴 식별 및 회피

### 5. 단위 테스트와 코드 설계의 관계
- **일방향 관계**: 테스트하기 어려운 코드는 품질이 낮다는 신호
- **단단한 결합**: 프로덕션 코드의 다른 부분들이 충분히 분리되지 않음
- **역방향 보장 없음**: 테스트하기 쉬운 코드가 반드시 좋은 코드는 아님

### 6. 커버리지 목표 설정의 위험성
- 특정 커버리지 수치를 목표로 하는 것은 위험
- 병원의 체온 조절 비유: 증상 치료가 아닌 원인 해결이 중요
- **권장사항**: 핵심 시스템 부분의 높은 커버리지는 좋지만, 이를 요구사항으로 만드는 것은 나쁨