# Chapter 13: Simplification by Separation - 추출된 정보

## 핵심 내용
- 복잡한 예약 허용 규칙을 단일 표에서 다단계 규칙으로 분해해 이해와 테스트를 용이하게 함
- 부분 규칙(월간 대여 수준, 누적 대여 수준 등)을 별도 계산으로 분리하고 조합 테이블로 최종 결정을 산출
- 분해 과정에서 빠진 조건·값(??)을 발견하고 기본값/추가 스토리 필요성을 식별
- 고객 대여 이력 집계 로직을 테스트하여 예약 결정과 연동

## 상세 핵심 내용

### 규칙 분할
- 원래의 다중 조건 표를 월간 대여, 누적 대여, 즐겨찾기 여부 등 독립 규칙으로 나눔
- 각 규칙은 명명된 레벨(MRLevelA 등)로 추상화되어 이후 조합 표에서 재사용
- 분리된 테이블로 인해 누락 케이스를 쉽고 빠르게 식별 가능

### 테스트 설계
- 각 부분 규칙에 대해 경계값을 포함한 테스트 테이블을 작성하여 조건 정의의 불명확성(??) 포착
- 조합 테이블에서 빠진 경우는 “허용 여부?” 열에 ??로 표시해 비즈니스 결정을 요구
- 예약 허용 결과 테스트를 통해 실제 고객 데이터가 올바른 결정을 내리는지 검증

### 데이터 및 집계 요구
- 예약 규칙을 위해 고객별 월간/누적 대여 수, 연체 수, 즐겨찾기 여부를 추적해야 함
- 체크인 시 카운터 갱신, 연체 여부 판단, 월별 초기화 등 운영 로직 정의
- 세부 이력 저장 여부는 향후 기능(검색, 분석 등)에 따라 확장 가능

## 상세 내용

### 단순화의 장점
- 작은 테이블로 나누면 이해 관계자가 규칙을 더 쉽게 검토하고 승인
- 테스트 유지보수가 용이하며 새로운 조건 추가 시 영향 범위가 명확해짐

### 기본값 처리
- “기타” 조건을 별도 레벨로 정의해 예상치 못한 입력 시 기록/조치 가능
- 디폴트 동작(예: 예약 불가) 결정으로 구현 간소화

### 고객 이력 테스트
- 실제 데이터가 없는 경우 테스트용 이력 테이블로 집계 로직을 검증
- 프로덕션 데이터가 존재하면 샘플 고객을 활용해 데이터 의존 문제를 조기에 발견

## 주요 화제

### 비즈니스 룰 모듈화
- 복잡한 조건식보다 명명된 상태 전환이 유지보수성·가독성을 높임

### 테스트 주도 요구 명확화
- 테스트 중 발견된 ?? 항목이 비즈니스 토론을 촉발해 누락 요구를 보완

### 데이터 전략 연계
- 집계 데이터만 저장할지, 상세 이력까지 보존할지 결정이 향후 분석/기능에 영향

## 부차 화제

### 기본 레벨 도입 권장
- 구현에 기본 레벨(MRLevelD 등)을 추가해 예외를 체계적으로 처리하도록 제안

### 월별 초기화 스케줄링
- 월말 집계 초기화 같은 배치/자동화 작업 필요성을 언급하며 운영 이슈를 예고
