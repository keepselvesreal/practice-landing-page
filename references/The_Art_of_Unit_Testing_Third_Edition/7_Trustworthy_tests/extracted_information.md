# 7장: Trustworthy tests - 추출된 정보

## 핵심 내용
신뢰할 수 있는 테스트의 특징과 신뢰성을 저해하는 요인들을 분석하고, 플레이키 테스트를 포함한 다양한 테스트 실패 원인을 진단하고 해결하는 방법을 다룹니다.

## 상세 핵심 내용
- **좋은 테스트의 3가지 기둥**: 신뢰성(Trustworthiness), 유지보수성(Maintainability), 가독성(Readability)
- **신뢰 지표**: 테스트 실패 시 걱정되고, 테스트 통과 시 안심되는 것이 신뢰할 수 있는 테스트
- **테스트 실패의 원인**: 실제 버그, 버그가 있는 테스트, 기능 변경으로 인한 구식 테스트, 테스트 간 충돌, 플레이키 테스트
- **거짓 양성과 거짓 음성**: 잘못된 실패(false positive)와 잘못된 성공(false negative) 탐지 방법
- **플레이키 테스트**: 간헐적으로 실패하는 테스트의 원인과 해결책

## 상세 내용

### 좋은 테스트의 3가지 기둥

#### 1. 신뢰성(Trustworthiness)
- **정의**: 개발자들이 테스트를 실행하고 결과를 확신을 가지고 받아들일 수 있는 특성
- **특징**: 버그가 없고 올바른 것을 테스트함
- **중요성**: 신뢰할 수 없으면 테스트 실행, 수정, 유지보수의 의미 상실

#### 2. 유지보수성(Maintainability)
- **정의**: 변경하기 쉽고 작은 프로덕션 코드 변경에 자주 수정할 필요가 없는 특성
- **위험성**: 유지보수가 어려운 테스트는 프로젝트 일정을 망치거나 방치됨
- **결과**: 개발자들이 테스트 유지보수와 수정을 포기하게 됨

#### 3. 가독성(Readability)
- **정의**: 테스트를 읽을 수 있을 뿐만 아니라 테스트가 잘못되었을 때 문제를 파악할 수 있는 능력
- **연관성**: 가독성 없이는 다른 두 기둥이 빠르게 무너짐
- **영향**: 테스트 유지보수가 어려워지고 이해할 수 없어서 신뢰할 수 없게 됨

### 테스트 신뢰성 판단 기준

#### 신뢰하지 않는 테스트의 신호
- **실패 시 걱정하지 않음**: 거짓 양성이라고 믿음
- **결과 무시**: 가끔 통과하거나 관련성이나 버그가 있다고 느껴서 무시
- **통과 시 걱정됨**: 거짓 음성이라고 믿음
- **수동 검증 필요**: 테스트 통과에도 "혹시나" 하여 수동으로 디버그하거나 테스트

#### 신뢰하는 테스트의 신호
- **실패 시 진짜 걱정**: 뭔가 깨졌다고 진심으로 우려하며 테스트가 틀렸다고 가정하지 않음
- **통과 시 안심**: 편안함을 느끼며 수동으로 테스트하거나 디버그할 필요를 느끼지 않음

### 테스트 실패의 원인들

#### 1. 실제 버그 발견 (좋은 실패)
- **유일한 정당한 실패 사유**: 프로덕션 코드의 진짜 버그 발견
- **대응**: 이것이 테스트의 존재 이유이므로 적절한 대응

#### 2. 버그가 있는 테스트 (거짓 양성)
- **원인**: 테스트 자체에 버그가 있어서 발생하는 잘못된 실패
- **증상**: 프로덕션 코드는 정상이지만 테스트가 실패
- **대응**: 테스트 코드 수정 필요

#### 3. 기능 변경으로 인한 구식 테스트
- **원인**: 프로덕션 코드의 의도적인 기능 변경
- **증상**: 이전 요구사항에 맞춰 작성된 테스트가 새 기능에 맞지 않음
- **대응**: 테스트를 새 요구사항에 맞게 업데이트

#### 4. 테스트 간 충돌
- **원인**: 여러 테스트가 공유 상태나 리소스를 두고 경쟁
- **증상**: 테스트 실행 순서에 따라 결과가 달라짐
- **대응**: 테스트 격리 개선, 상태 정리

#### 5. 플레이키 테스트
- **정의**: 간헐적으로 실패하는 불안정한 테스트
- **원인**: 타이밍, 외부 의존성, 비결정적 요소
- **대응**: 근본 원인 제거, 안정화 작업

### 플레이키 테스트 처리

#### 일반적인 원인
- **타이밍 이슈**: 비동기 코드에서 적절한 대기 없음
- **외부 의존성**: 네트워크, 파일시스템, 데이터베이스 상태 변화
- **공유 상태**: 테스트 간 상태 공유로 인한 간섭
- **비결정적 요소**: 랜덤 값, 시간 의존성, 병렬 실행

#### 해결 전략
- **의존성 제거**: 외부 의존성을 스텁/목으로 교체
- **적절한 대기**: async/await, done() 콜백 올바른 사용
- **상태 격리**: 각 테스트가 독립적으로 실행되도록 설계
- **결정적 만들기**: 랜덤 요소를 고정값으로 대체

### 거짓 음성 탐지

#### 거짓 음성의 위험성
- **정의**: 실제로는 버그가 있지만 테스트가 통과하는 상황
- **결과**: 버그가 프로덕션에 배포되어 사용자에게 영향
- **탐지 어려움**: 테스트가 통과하므로 문제를 인식하기 어려움

#### 탐지 방법
- **코드 변형**: 의도적으로 버그를 넣어 테스트가 실패하는지 확인
- **커버리지 분석**: 테스트되지 않는 코드 경로 식별
- **뮤테이션 테스트**: 자동으로 코드를 변형하여 테스트 품질 검증

## 주요 화제

### 테스트 품질 관리
- **지속적인 평가**: 테스트의 3가지 기둥을 정기적으로 평가
- **팀 문화**: 테스트 품질에 대한 팀 전체의 인식과 책임감
- **코드 리뷰**: 테스트 코드도 프로덕션 코드만큼 엄격하게 리뷰

### 신뢰성 구축 전략
- **점진적 개선**: 한 번에 모든 테스트를 고치려 하지 말고 점진적으로 개선
- **우선순위**: 가장 중요하고 자주 실패하는 테스트부터 개선
- **메트릭 추적**: 테스트 안정성, 실행 시간, 성공률 등 지표 모니터링

### 개발 워크플로우 통합
- **CI/CD 파이프라인**: 플레이키 테스트가 배포를 막지 않도록 관리
- **실패 대응**: 테스트 실패 시 체계적인 원인 분석과 대응 프로세스
- **팀 소통**: 테스트 상태와 문제점에 대한 팀 내 투명한 소통

## 부차 화제

### 도구와 기법
- **테스트 러너 설정**: Jest, Mocha 등에서 플레이키 테스트 감지 설정
- **재시도 메커니즘**: 실패한 테스트의 자동 재실행 설정
- **리포팅**: 테스트 안정성과 실패 패턴 분석을 위한 도구

### 조직적 고려사항
- **시간 투자**: 테스트 개선을 위한 충분한 시간 확보
- **기술 부채**: 테스트 품질 저하도 기술 부채로 인식하고 관리
- **교육**: 팀원들의 테스트 작성 기술 향상을 위한 교육

### 성능과 안정성
- **실행 시간**: 테스트 신뢰성과 실행 속도 사이의 균형
- **리소스 사용**: 테스트 환경의 안정성과 리소스 효율성
- **스케일링**: 테스트 수가 증가할 때의 안정성 유지 방법

### 문화적 측면
- **실패에 대한 인식**: 테스트 실패를 부정적으로 보지 않는 문화
- **품질 우선**: 개발 속도보다 테스트 품질을 우선시하는 문화
- **지속적 개선**: 테스트 품질 개선을 지속적으로 추진하는 문화