- [[after-commit-96938e2]]

## 목차

- Phase 2-2: Integration 레벨 확장 (DB + SMTP 분리)
  - 작업 맥락
  - 작업 분석
  - 수행 내용
    - 1단계: 테스트 명명 규칙 변경 (When-Then 패턴)
    - 2단계: DB Integration 테스트 구현 (TDD)
    - 3단계: SMTP Integration 환경 설정
    - 4단계: SMTP Integration 테스트 구현 (TDD)
    - 5단계: 재시도 로직 + CRITICAL 로그 구현 (TDD)
  - 이해 요소
    - When-Then 테스트 명명 패턴
    - Mock SMTP 서버 (aiosmtpd)
    - tenacity 재시도 로직
  - 판단 요소
    - 테스트 파일 분리: DB vs SMTP
    - 재시도 로직 try-except 구조
  - 예외 요소
    - SMTP 테스트에서 Foreign Key 제약 오류
    - 이메일 본문 base64 인코딩 검증
    - caplog가 로그를 캡처하지 못하는 문제
  - 최종 결과
